---
theme: default
addons:
  - tldraw
title: 拓课堂2025暑期牛剑营课程
titleTemplate: "%s - 拓课堂"
author: 拓课堂
date: 2025
logo: ./logo/company-logo.png
info: "拓课堂2025暑期牛剑营课程 Lesson 1: Calculus"
favicon: ./logo/favicon.png
colorSchema: light
watermarkEnabled: true
---

# 拓课堂2025暑期牛剑营课程

## Lesson 1: Calculus

---
layout: center
class: text-center
section: '1.1 极限
---

# 1.1 极限(Limit)

---

# Definition

<Definition title="Limit">

Formally, the definition of the "limit of $\displaystyle f(x)$ as $\displaystyle x$ approaches $\displaystyle c$" is given as follows. The limit is a real number $\displaystyle L$ so that, given an arbitrary real number $\displaystyle \epsilon > 0$ (thought of as the "error"), there is a $\displaystyle \delta > 0$ such that, for any $\displaystyle x$ satisfying $\displaystyle 0 < |x - c| < \delta$, it holds that $\displaystyle |f(x) - L| < \epsilon$. This is known as $(\displaystyle \epsilon, \delta)$-definition of limit.

Note:

(a) It is possible to define the notion of "tending to infinity" in the domain of $\displaystyle f$,

$$ \displaystyle \lim_{x \to \infty} f(x) = L $$

In this expression, the infinity is considered to be signed: either $\displaystyle +\infty$ or $\displaystyle -\infty$.

(b) It is also possible to define the notion of "tending to infinity" in the value of $\displaystyle f$,

$$ \displaystyle \lim_{x \to c}f(x) = \infty $$

</Definition>

---

# One-sided vs. two-sided

<Note type="tip">

It is possible to define the notion of having a "left-handed" limit ("from below"), and a notion of a "right-handed" limit ("from above"). These need not agree.

For example, $\displaystyle f: \mathbb{R} \rightarrow \mathbb{R}$, defined such that $\displaystyle f(x) = 0$ if $\displaystyle x \leq 0$, and $\displaystyle f(x) = 1$ if $\displaystyle x > 0$. At $\displaystyle x = 0$, $\displaystyle \lim_{x \rightarrow 0^{-}} f(x) = 0$, and $\displaystyle \lim_{x \rightarrow 0^{+}} f(x) = 1$, and from this it can be deduced $\displaystyle \lim_{x \rightarrow 0} f(x)$ doesn't exist, because $\displaystyle \lim_{x \rightarrow 0^{-}} f(x) \neq \lim_{x \rightarrow 0^{+}} f(x)$.

</Note>

---

# Theorems on limits

<Theorem title="Theorems on limits">

- $\displaystyle \lim_{x \rightarrow c}[kf(x)] = k\lim_{x \rightarrow c} f(x)$, where $\displaystyle k$ is a constant
- $\displaystyle \lim_{x \rightarrow c}[f(x) \pm g(x)] = \lim_{x \rightarrow c} f(x) \pm \lim_{x \rightarrow c} g(x)$
- $\displaystyle \lim_{x \rightarrow c}[f(x)g(x)] = \lim_{x \rightarrow c} f(x) \cdot \lim_{x \rightarrow c} g(x)$
- $\displaystyle \lim_{x \rightarrow c}\left[\frac{f(x)}{g(x)}\right] = \frac{\lim_{x \rightarrow c} f(x)}{\lim_{x \rightarrow c} g(x)}$, provided $\displaystyle \lim_{x \rightarrow c} g(x) \neq 0$

</Theorem>

---

# Useful results for limits

<Remark type="remember">

- $\displaystyle \lim_{x \rightarrow a} c = c$, where $\displaystyle c$ is a constant
- $\displaystyle \lim_{x \rightarrow +\infty} \frac{1}{x^n} = 0$, $\displaystyle n \in \mathbb{R}$
- $\displaystyle \lim_{x \rightarrow -\infty} \frac{1}{x^n} = 0$, $\displaystyle n \in \mathbb{R}$
- $\displaystyle \lim_{n \rightarrow +\infty} \left(1 + \frac{1}{n}\right)^n = e$
- $\displaystyle \lim_{x \rightarrow 0} \frac{\sin x}{x} = 1$

</Remark>

---

# L'Hôpital's rule

<Theorem title="L'Hôpital's rule">

L'Hôpital's rule states that for functions $\displaystyle f$ and $\displaystyle g$ which are differentiable on an open interval $\displaystyle I$ except possibly at a point $\displaystyle c$ contained in $\displaystyle I$, if $\displaystyle \lim_{x \rightarrow c} f(x) = \lim_{x \rightarrow c} g(x) = 0$ or $\displaystyle \pm \infty$, and $\displaystyle g'(x) \neq 0$ for all $\displaystyle x$ in $\displaystyle I$ with $\displaystyle x \neq c$, and $\displaystyle \lim_{x \rightarrow c} \frac{f'(x)}{g'(x)}$ exists, then

$$\displaystyle \lim_{x \rightarrow c} \frac{f(x)}{g(x)} = \lim_{x \rightarrow c} \frac{f'(x)}{g'(x)}$$

The differentiation of the numerator and denominator often simplifies the quotient or converts it to a limit that can be evaluated directly.

</Theorem>

---

# L'Hôpital's rule conditions

<Note type="warning">

All four conditions for L'Hôpital's rule are necessary:

1. Indeterminacy of form: $\displaystyle \lim_{x \rightarrow c} f(x) = \lim_{x \rightarrow c} g(x) = 0$ or $\displaystyle \pm \infty$; and

2. Differentiability of functions: $\displaystyle f(x)$ and $\displaystyle g(x)$ are differentiable on an open interval $\displaystyle \mathcal{I}$ except possibly at a point $\displaystyle c$ contained in $\displaystyle \mathcal{I}$ (the same point from the limit); and

3. Non-zero derivative of denominator: $\displaystyle g'(x) \neq 0$ for all $\displaystyle x$ in $\displaystyle \mathcal{I}$ with $\displaystyle x \neq c$; and

4. Existence of limit of the quotient of the derivatives: $\displaystyle \lim_{x \rightarrow c} \frac{f'(x)}{g'(x)}$ exists.

</Note>

---

# Example 1

<Example>

Use L'Hôpital's rule to prove that $\displaystyle \lim_{x \rightarrow 0} \frac{\sin x}{x} = 1$

</Example>

---

# Example 2

<Example>

Find $\displaystyle \lim_{x \rightarrow +\infty} \frac{x + \cos x}{x}$, you may use L'Hôpital's rule.

How about $\displaystyle \lim_{x \rightarrow \infty} \frac{e^x + e^{-x}}{e^x - e^{-x}}$

</Example>

---
layout: center
class: text-center
section: '1.2 微分'
---

# 1.2 微分(Differentiation)

---

# First principle of differentiation

<Definition title="First principle of differentiation">

We say a function $\displaystyle f$ is differentiable at a point $\displaystyle x_0$ if

$$\displaystyle f'(x_0) = \lim_{h \rightarrow 0} \frac{f(x_0 + h) - f(x_0)}{h}$$

exists. Also so we call $\displaystyle f'(x_0)$ to be the derivative of $\displaystyle f$ at point $\displaystyle x_0$.

</Definition>

---

# Example 3

<Example>

Use the first principle to derive the derivative of $\displaystyle x^n$. What are the possible cases to consider?

</Example>

---

# Exercise 3

<ClassQuestion title="Exercise">

Use the first principle to derive the derivative of $\displaystyle \sin(x)$ and $\displaystyle \cos(x)$

</ClassQuestion>

---

# Example 4

<Example>

Use the first principle to derive the derivative of $\displaystyle \ln(x)$

</Example>

---

# Example 5

<Example>

Use the first principle to derive the product rule

Let $\displaystyle h(x) = f(x)g(x)$.

Then $\displaystyle h'(x) = f'(x)g(x) + f(x)g'(x)$

</Example>

---

# Small "o" and big "O" notations

<Note type="tip">

(i) "$\displaystyle f(x) = o(g(x))$ as $\displaystyle x \rightarrow x_0$" if $\displaystyle \lim_{x \rightarrow x_0} \frac{f(x)}{g(x)} = 0$. Intuitively, $\displaystyle f(x)$ is much smaller than $\displaystyle g(x)$.

(ii) "$\displaystyle f(x) = O(g(x))$ as $\displaystyle x \rightarrow x_0$" if $\displaystyle \frac{f(x)}{g(x)}$ is bounded as $\displaystyle x \rightarrow x_0$. Intuitively, $\displaystyle f(x)$ is about as big as $\displaystyle g(x)$.

Note that for $\displaystyle f(x) = O(g(x))$ to be true, $\displaystyle \lim_{x \rightarrow x_0} \frac{f(x)}{g(x)}$ need not exist.

Usually, $\displaystyle x_0$ is either 0 or infinity. Clearly, we have $\displaystyle f(x) = o(g(x))$ implies $\displaystyle f(x) = O(g(x))$

</Note>

---

# Small "o" and big "O" notations

<Example>

For example

$x \rightarrow \infty$

$x^2 + x = O(x^2) \quad x^2 = o(x^3)$

$x \rightarrow 0$

$x^2 + x = O(x) \quad x^2 = o(x)$

</Example>

---

# Small "o" and big "O" notations

<Example>

For example

$\begin{aligned} & \sin x = x - \frac{x^3}{3!} + \frac{x^5}{5!} + O(x^7) \\ & \sin x = x - \frac{x^3}{3!} + o(x^3)\end{aligned}$

</Example>

---

# Example 6

<Example>

(a) Prove that $f(x + h) = f(x) + hf'(x) + o(h)$

(b) Hence prove the Chain rule $\displaystyle \left(\frac{dy}{dx} = \frac{dy}{du} \frac{du}{dx} \right)$

</Example>

---

# Implicit differentiation

<Definition title="Implicit differentiation">

In calculus, a method called implicit differentiation makes use of the chain rule $\displaystyle \left(\frac{dy}{dx} = \frac{dy}{du} \frac{du}{dx} \right)$ to differentiate implicitly defined functions.

</Definition>

---

# Example 7

<Example>

Find an expression, in terms of $x$ and/or $y$, for $\displaystyle \frac{dy}{dx}$ and $\displaystyle \frac{d^2y}{dx^2}$ in each of the following:

(a) $\displaystyle x^{\frac{2}{3}} + y^{\frac{2}{3}} = a^{\frac{2}{3}}$ where $\displaystyle 0 < x < a,\, y > 0$,

(b) $\displaystyle y = (\sin x)^{\sin x},\ 0 < x < \frac{\pi}{2}$.

</Example>

---
layout: center
class: text-center
section: '1.3 麦克劳林级数'
---

# 1.3 麦克劳林级数(Maclaurin series)

---

# Definition

<Definition title="Maclaurin series">

The Maclaurin series takes the form:

$$f(0) + \frac{f'(0)}{1!}x + \frac{f''(0)}{2!}x^2 + \frac{f'''(0)}{3!}x^3 + \cdots,$$

or in the compact sigma notation:

$$\sum_{n=0}^{\infty} \frac{f^{(n)}(0)}{n!}x^n$$

Note: we assume that $f(x)$ is infinitely differentiable

</Definition>

---

# *Taylor series

<Note type="tip">

Maclaurin series is a special type of Taylor series where the series expansion is taken at $x = 0$.

In general, the series expansion for an infinitely differentiable function $f(x)$ at point $x = a$ has the form:

$$\sum_{n=0}^{\infty} \frac{f^{(n)}(a)}{n!}(x-a)^n$$

Note that this only gives a local approximation around $x$. This does not necessarily tell anything about values of $f(x)$ far from $x$ (but sometimes does).

</Note>

---

# Example 8

<Example>

Determine by any method the first three non-zero terms of the Taylor expansions about $x = 0$ of

(i) $(x^2 + a)^{-3/2}$,

(ii) $\ln(\cos x)$,

(iii) $\exp\left\{-\frac{1}{(x-a)^2}\right\}$, where $a$ is a constant.

</Example>

---

# List of Maclaurin series

<Remark type="remember">

- $\displaystyle e^x = \exp(x) = 1 + x + \frac{x^2}{2!} + \ldots + \frac{x^r}{r!} + \ldots$
- $\displaystyle \ln(1+x) = x - \frac{x^2}{2} + \frac{x^3}{3} - \ldots + (-1)^{r+1}\frac{x^r}{r} + \ldots \quad (-1 < x \leqslant 1)$
- $\displaystyle \sin x = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \ldots + (-1)^r\frac{x^{2r+1}}{(2r+1)!} + \ldots$
- $\displaystyle \cos x = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \ldots + (-1)^r\frac{x^{2r}}{(2r)!} + \ldots$
- $\displaystyle \sinh x = x + \frac{x^3}{3!} + \frac{x^5}{5!} + \ldots + \frac{x^{2r+1}}{(2r+1)!} + \ldots$
- $\displaystyle \cosh x = 1 + \frac{x^2}{2!} + \frac{x^4}{4!} + \ldots + \frac{x^{2r}}{(2r)!} + \ldots$

</Remark>

---

# Example 9

<Example>

Use standard series to find the Maclaurin expansion of:

$(a)$ $\sin(3x)$

$(b)$ $e^x\cos(x)$

$(c)$ $\ln(2+x)$

</Example>

---

# Example 10

<Example>

(i) Write down or determine the Taylor series for $f(x) = e^{ax}$ about $x = 1$.

(ii) Write down or determine the Taylor series for $\ln(1+x)$ about $x = 0$. Then show that

$$\lim_{k \rightarrow \infty} k\ln(1+x/k) = x$$

and deduce that

$$\lim_{k \rightarrow \infty}(1+x/k)^k = e^x$$

What property of the exponential function did you need?

</Example>

---

# Binomial series

<Theorem title="Binomial series">

The binomial series is the power series

$$(1+x)^\alpha = \sum_{n=0}^{\infty}\left(\begin{array}{l}
\alpha \\
n
\end{array}\right) x^n$$

whose coefficients are the generalized binomial coefficients

$$\left(\begin{array}{l}
\alpha \\
n
\end{array}\right) = \prod_{k=1}^n \frac{\alpha-k+1}{k} = \frac{\alpha(\alpha-1) \cdots(\alpha-n+1)}{n!}$$

(If $n = 0$, this product is an empty product and has value 1.)

The series is only valid for $|x| < 1$.

This is also known as the range of validity.

</Theorem>

---

# Example 11

<Example>

Find the Maclaurin series for

(a) $(1+x)^{-1}$

(b) $(1+x)^{\frac{1}{2}}$

State the respective range of validity.

</Example>

---

# Technique

<Note type="tip">

If the expansion of $(a+x)^n$ is needed, where $n \in \mathbb{Q} \backslash \mathbb{Z}^{+}$, we can do it in 2 ways:

(i) For ascending powers of $x$, we rewrite

$$(a+x)^n = a^n\left(1+\frac{x}{a}\right)^n$$

before applying the binomial expansion.

In this case, the expansion is valid for $\displaystyle \left|\frac{x}{a}\right| < 1$ (i.e. small $x$)

(ii) For descending powers of $x$, we rewrite

$$(a+x)^n = (x+a)^n = x^n\left(1+\frac{a}{x}\right)^n$$

before applying the binomial expansion.

In this case, the expansion is valid for $\displaystyle \left|\frac{a}{x}\right| < 1$ (i.e. large $x$)

</Note>

---

# Example 12

<Example>

Expand the following in ascending powers of $x$, up to and including the term in $x^3$. In each case, state the range of values of $x$ for which the expansion is valid.

(a) $\displaystyle (1-2x)^{\frac{1}{3}}$

(b) $\displaystyle \frac{1-x^2}{(1+x^3)^{\frac{1}{3}}}$

</Example>

---

# Linear approximation

<Note>

Given a function $\displaystyle y = f(x)$, the Maclaurin series expansion is

$$\displaystyle y = f(0) + f'(0)x + \frac{f''(0)}{2!}x^2 + \frac{f^{(3)}(0)}{3!}x^3 + \ldots + \frac{f^{(n)}(0)}{n!}x^n + \ldots$$

The graph of $\displaystyle y = f(x)$ passes through $\displaystyle (0, f(0))$ and the gradient of $\displaystyle y = f(x)$ at $\displaystyle (0, f(0))$ is $\displaystyle f'(0)$. Thus, the equation of the tangent to $\displaystyle y = f(x)$ at $\displaystyle x = 0$ is $\displaystyle y = f(0) + f'(0)x$.

Notice that this equation corresponds to the Maclaurin series for $\displaystyle y = f(x)$ up to and including the term in $\displaystyle x$.

For example, $\displaystyle \sqrt{1+x} = 1 + \frac{1}{2}x - \frac{1}{8}x^2 + \frac{1}{16}x^3 + \ldots$, so $\displaystyle y = 1 + \frac{1}{2}x$ is a tangent to the graph of $\displaystyle y = \sqrt{1+x}$ at $\displaystyle x = 0$

</Note>

---

# Example 13

<Example>

It is given that $\displaystyle f(x) = \frac{1}{\sqrt{9-x^2}}$, where $\displaystyle -3 < x < 3$

(i) Find the binomial expansion for $\displaystyle f(x)$, up to and including the term in $\displaystyle x^6$. Give the coefficients as exact fractions in their simplest form.

(ii) Hence, or otherwise, find the first four non-zero terms of the Maclaurin series for $\displaystyle \sin^{-1}\left(\frac{1}{3}x\right)$. Give the coefficients as exact fractions in their simplest form.

</Example>

---

# Example 14

<Example>

If the coefficient of the $r^{\text{th}}$ term from the beginning of the expansion: the coefficient of the term from the end of the expansion of $(3x+5)^n$ in descending powers of $x$ is $27: 125$. find a relation between $n$ and $r$.

</Example>

---

# Example 15

<Example>

By giving $x$ appropriate numerical values in the expansion of $(1+x)^{2n}$, where $n$ is a positive integer, prove that

$(a)$ $\left(\begin{array}{c}2n \\ 1\end{array}\right) + \left(\begin{array}{c}2n \\ 2\end{array}\right) + \left(\begin{array}{c}2n \\ 3\end{array}\right) + \left(\begin{array}{c}2n \\ 4\end{array}\right) + \ldots + \left(\begin{array}{c}2n \\ 2n-1\end{array}\right) = 2(2^{2n-1}-1)$

$(b)$ $1-2\left(\begin{array}{c}2n \\ 1\end{array}\right)+4\left(\begin{array}{c}2n \\ 2\end{array}\right)-8\left(\begin{array}{c}2n \\ 3\end{array}\right)+\ldots+(-2)^{2n} = 1$

$(c)$ $\left(\begin{array}{c}2n \\ 0\end{array}\right)+\left(\begin{array}{c}2n \\ 2\end{array}\right)+\left(\begin{array}{c}2n \\ 4\end{array}\right)+\ldots+\left(\begin{array}{c}2n \\ 2n\end{array}\right) = \left(\begin{array}{c}2n \\ 1\end{array}\right)+\left(\begin{array}{c}2n \\ 3\end{array}\right)+\left(\begin{array}{c}2n \\ 5\end{array}\right)+\ldots+\left(\begin{array}{c}2n \\ 2n-1\end{array}\right) = 2^{2n-1}$

</Example>

---
layout: center
class: text-center
section: '1.4 积分'
---

# 1.4 积分(Integration)

---

# Riemann Sum

<Definition title="Riemann Sum">

Let $\displaystyle f:[a, b] \rightarrow \mathbb{R}$ be a function defined on a closed interval $\displaystyle [a, b]$, and $\displaystyle P = (x_0, x_1, \ldots, x_n)$ a partition of $\displaystyle [a, b]$, that is

$$\displaystyle a = x_0 < x_1 < x_2 < \cdots < x_n = b$$

A Riemann sum $\displaystyle S$ of $\displaystyle f$ over $\displaystyle [a, b]$ with partition $\displaystyle P$ is defined as

$$\displaystyle S = \sum_{i=1}^n f(x_i^*)\Delta x_i,$$

where $\displaystyle \Delta x_i = x_i - x_{i-1}$ and $\displaystyle x_i^* \in [x_{i-1}, x_i]$. One might produce different Riemann sums depending on which $\displaystyle x_i^*$'s are chosen.

</Definition>

---

# Graph

<Remark type="remember">

The three most common types of Riemann sums are left, right, and middle sums.

</Remark>

<img src="/Example/assets/1.jpg" alt="Riemann sums illustration" style="max-width: 80%; height: auto; border: 1px solid #ccc; display: block; margin: 0 auto;" />

---

# Fundamental theorem of calculus

<Note type="tip">

The fundamental theorem of calculus is a theorem that links the concept of differentiating a function with the concept of integrating a function. The two operations are inverses of each other apart from a constant value.

The first part of the theorem, the first fundamental theorem of calculus, states that for a function $\displaystyle f$, an antiderivative or indefinite integral $\displaystyle F$ may be obtained as the integral of $\displaystyle f$ over an interval with a variable upper bound. This implies the existence of antiderivatives for continuous functions.

Conversely, the second part of the theorem, the second fundamental theorem of calculus, states that the integral of a function $\displaystyle f$ over a fixed interval is equal to the change of any antiderivative $\displaystyle F$ between the ends of the interval. This greatly simplifies the calculation of a definite integral provided an antiderivative can be found by symbolic integration, thus avoiding numerical integration.

</Note>

---

# Fundamental theorem of calculus

<Theorem title="Fundamental theorem of calculus">

Let $\displaystyle f$ be a continuous real-valued function defined on a closed interval $\displaystyle [a, b]$. Let $\displaystyle F$ be the function defined, for all $\displaystyle x$ in $\displaystyle [a, b]$, by

$$\displaystyle F(x) = \int_a^x f(t) dt$$

Then $\displaystyle F$ is uniformly continuous on $\displaystyle [a, b]$ and differentiable on the open interval $\displaystyle (a, b)$, and

$$\displaystyle F'(x) = f(x)$$

for all $\displaystyle x$ in $\displaystyle (a, b)$ so $\displaystyle F$ is an antiderivative of $\displaystyle f$.

</Theorem>

---

# Corollary

<Theorem title="Corollary">

The fundamental theorem is often employed to compute the definite integral of a function $\displaystyle f$ for which an antiderivative $\displaystyle F$ is known. Specifically, if $\displaystyle f$ is a real-valued continuous function on $\displaystyle [a, b]$ and $\displaystyle F$ is an antiderivative of $\displaystyle f$ in $\displaystyle [a, b]$ then

$$\displaystyle \int_a^b f(t) dt = F(b) - F(a)$$

</Theorem>

---

# Mean value theorem

<Theorem>

The fundamental theorem of calculus is proved using the mean value theorem, which states that:

Let $\displaystyle f:[a, b] \rightarrow \mathbb{R}$ be a continuous function on the closed interval $\displaystyle [a, b]$, and differentiable on the open interval $\displaystyle (a, b)$, where $\displaystyle a < b$. Then there exists some $\displaystyle c$ in $\displaystyle (a, b)$ such that

$$\displaystyle f'(c) = \frac{f(b) - f(a)}{b - a}$$

</Theorem>

<img src="/Example/assets/2.png" alt="Mean value theorem illustration" style="max-width: 30%; height: auto; border: 1px solid #ccc; display: block; margin: 0 auto;" />

---

# Definite Integral

<Remark type="caution">

Some of the MAT questions on calculus would be about computing the definite integral.

</Remark>

---

# Example 16

<Example>

What is the value of $\displaystyle \int_0^1(e^x-x)(e^x+x) \mathrm{d}x$?

$(a)$ $\displaystyle \frac{3e^2-2}{6}$,

$(b)$ $\displaystyle \frac{3e^2+2}{6}$,

$(c)$ $\displaystyle \frac{2e^2-3}{6}$,

$(d)$ $\displaystyle \frac{3e^2-5}{6}$,

$(e)$ $\displaystyle \frac{e^2+3}{6}$.

</Example>

---

# Integration technique

<Note type="tip">

There are some techniques we can apply to find the values of indefinite integrals:

(a) Integration by substitution

(b) Integration by part

</Note>

---

# Comparing integrals

<Note>

Another common type of question on calculus is about comparing integrals.

There are some results we can use to help make comparisons without calculating the value of integrals:

- $\displaystyle \int_a^b f(x) \mathrm{d}x = -\int_b^a f(x) \mathrm{d}x$
- $\displaystyle \int_a^b f(x) \mathrm{d}x + \int_b^c f(x) \mathrm{d}x = \int_a^c f(x) \mathrm{d}x$
- if $\displaystyle f(x) > 0$ for all $\displaystyle x \in [a,b]$, $\displaystyle \int_a^b f(x) \mathrm{d}x > 0$
- if $\displaystyle f(x) > g(x)$ for all $\displaystyle x \in [a,b]$, $\displaystyle \int_a^b f(x) \mathrm{d}x > \int_a^b g(x) \mathrm{d}x$
- if $\displaystyle m < f(x) < M$ for all $\displaystyle x \in [a,b]$, $\displaystyle (b-a)m < \int_a^b f(x) \mathrm{d}x < (b-a)M$

Note: Always look out for special features (periodicity, upper/lower bound, zero, etc.) in the integrand.

</Note>

---

# Example 17

<Example>

Which of these integrals has the largest value? You are not expected to calculate the exact value of any of these.

$(a)$ $\displaystyle \int_0^2(x^2-4) \sin^8(\pi x) \mathrm{d}x$

$(b)$ $\displaystyle \int_0^{2\pi}(2+\cos x)^3 \mathrm{d}x$

$(c)$ $\displaystyle \int_0^\pi \sin^{100} x \mathrm{d}x$

$(d)$ $\displaystyle \int_0^\pi(3-\sin x)^6 \mathrm{d}x$

$(e)$ $\displaystyle \int_0^{8\pi} 108(\sin^3 x-1) \mathrm{d}x$

</Example>

---

# Exercise 17

<Question title="Exercise">

Let

$$\displaystyle f(x) = \int_0^1(xt)^2 \mathrm{d}t, \quad \text{and} \quad g(x) = \int_0^x t^2 \mathrm{d}t$$

Let $\displaystyle A > 0$. Which of the following statements is true?

$(a)$ $\displaystyle g(f(A))$ is always bigger than $\displaystyle f(g(A))$.

$(b)$ $\displaystyle f(g(A))$ is always bigger than $\displaystyle g(f(A))$.

$(c)$ They are always equal.

$(d)$ $\displaystyle f(g(A))$ is bigger if $\displaystyle A < 1$, and $\displaystyle g(f(A))$ is bigger if $\displaystyle A > 1$.

$(e)$ $\displaystyle g(f(A))$ is bigger if $\displaystyle A < 1$ and $\displaystyle f(g(A))$ is bigger if $\displaystyle A > 1$.

</Question>

---

# Area under the curve

<Note type="tip">

Integration is often used to find the area under the graph.

A definite integral of a function can be represented as the signed area of the region bounded by its graph and the horizontal axis. In the above graph as an example, the integral of $\displaystyle f(x)$ is the blue $\displaystyle (+)$ area subtracted by the yellow $\displaystyle (-)$ area.

</Note>

<img src="/Example/assets/4.png" alt="Area under curve illustration" style="max-width: 20%; height: auto; border: 1px solid #ccc; display: block; margin: 0 auto;" />

---

# Example 18

<Example>

Let $\displaystyle 0 < k < 2$. Below is sketched a graph of $\displaystyle y = f_k(x)$ where $\displaystyle f_k(x) = x(x-k)(x-2)$. Let $\displaystyle A(k)$ denote the area of the shaded region.

</Example>

<img src="/Example/assets/3.png" alt="Graph of f_k(x)" style="max-width: 70%; height: auto; border: 1px solid #ccc; display: block; margin: 0 auto;" />

---

# Example 18

<Example>

(i) Without evaluating them, write down an expression for $A(k)$ in terms of two integrals.

(ii) Explain why $A(k)$ is a polynomial in $k$ of degree 4 or less. [You are not required to calculate $A(k)$ explicitly.]

(iii) Verify that $\displaystyle f_k(1+t) = -f_{2-k}(1-t)$ for any $\displaystyle t$.

(iv) How can the graph of $\displaystyle y = f_k(x)$ be transformed to the graph of $\displaystyle y = f_{2-k}(x)$?

Deduce that $\displaystyle A(k) = A(2-k)$.

(v) Explain why there are constants $\displaystyle a, b, c$ such that

$$\displaystyle A(k) = a(k-1)^4 + b(k-1)^2 + c$$

[You are not required to calculate $a, b, c$ explicitly.]

</Example>

---

# Exercise 18

<Question title="Exercise">

A line is tangent to the parabola $\displaystyle y = x^2$ at the point $\displaystyle (a, a^2)$ where $\displaystyle a > 0$. The area of the region bounded by the parabola, the tangent line, and the $\displaystyle x$-axis equals

$(a)$ $\displaystyle \frac{a^2}{3}$,

$(b)$ $\displaystyle \frac{2a^2}{3}$,

$(c)$ $\displaystyle \frac{a^3}{12}$,

$(d)$ $\displaystyle \frac{5a^3}{6}$,

$(e)$ $\displaystyle \frac{a^4}{10}$.

</Question>

---
layout: center
class: text-center
section: '1.5 数值积分'
---

# 1.5 数值积分(Numerical integration)

---

# Riemann sum

<Question title="Over or under estimation">

If the graph is increasing on the interval, then the left-sum is an underestimate of the actual value and the right-sum is an overestimate.

If the curve is decreasing, then the right-sum is an underestimate and the left-sum is an overestimate.

In summary, it is judged by the monotonicity of the function.

</Question>

---

# Trapezium rule

<Note type="tip">

Generally speaking, the result obtained by the trapezium rule is $\displaystyle \frac{\text{right sum}+\text{left sum}}{2}$.

</Note>

<div style="display: flex; align-items: center; gap: 20px;">

<div style="flex: 1;">

<Note type="tip">

The trapezoidal rule works by approximating the region under the graph of the function $\displaystyle f(x)$ as a trapezoid and calculating its area. It follows that

$$\displaystyle \int_a^b f(x) dx \approx (b-a) \cdot \frac{1}{2}(f(a)+f(b))$$

</Note>

</div>

<div style="flex: 1;">

<img src="/Example/assets/5.png" alt="Trapezium rule illustration" style="max-width: 75%; height: auto; border: 1px solid #ccc;" />

</div>

</div>

---

# Trapezium rule

<Theorem title="Trapezium rule">

The integral can be even better approximated by partitioning the integration interval. Let $\displaystyle \{x_k\}$ be a partition of $\displaystyle [a, b]$ such that $\displaystyle a = x_0 < x_1 < \cdots < x_{N-1} < x_N = b$ and $\displaystyle \Delta x_k$ be the length of the $\displaystyle k$-th subinterval (that is, $\displaystyle \Delta x_k = x_k - x_{k-1}$), then

$$\displaystyle \int_a^b f(x) dx \approx \sum_{k=1}^N \frac{f(x_{k-1})+f(x_k)}{2} \Delta x_k$$

When the partition has a regular spacing, as is often the case, that is, when all the $\displaystyle \Delta x_k$ have the same value $\displaystyle \Delta x$, the formula can be simplified for calculation efficiency by factoring $\displaystyle \Delta x$ out:

$$\displaystyle \int_a^b f(x) dx \approx \frac{\Delta x}{2}\left(f(x_0)+2f(x_1)+2f(x_2)+2f(x_3)+2f(x_4)+\cdots+2f(x_{N-1})+f(x_N)\right)$$

</Theorem>

---

# Example 19

<Example>

When the trapezium rule is used to estimate the integral

$$\displaystyle \int_0^1 2^x \mathrm{d}x$$

by dividing the interval $\displaystyle 0 \leqslant x \leqslant 1$ into $\displaystyle N$ subintervals the answer achieved is

$(a)$ $\displaystyle \frac{1}{2N}\left\{1+\frac{1}{2^{1/N}+1}\right\}$,

$(b)$ $\displaystyle \frac{1}{2N}\left\{1+\frac{2}{2^{1/N}-1}\right\}$,

$(c)$ $\displaystyle \frac{1}{N}\left\{1-\frac{1}{(2^{1/N}-1)}\right\}$,

$(d)$ $\displaystyle \frac{1}{2N}\left\{\frac{5}{2^{1/N}+1}-1\right\}$.

</Example>

---

# Error

<Question title="Over or under estimation">

If the graph is concave-up/convex, the result obtained by the trapezium rule will be an over-estimation.

If the curve is concave-down/concave, the result obtained by the trapezium rule will be an under-estimation.

In summary, it is judged by the convexity (second derivative) of the function.

</Question>

---

# Example 20

<Example>

If the trapezium rule is used to estimate the integral

$$\displaystyle \int_0^1 f(x) \mathrm{d}x$$

by splitting the interval $\displaystyle 0 \leqslant x \leqslant 1$ into 10 intervals then an overestimate of the integral is produced. It follows that

$(a)$ the trapezium rule with 10 intervals underestimates $\displaystyle \int_0^1 2f(x) \mathrm{d}x$;

$(b)$ the trapezium rule with 10 intervals underestimates $\displaystyle \int_0^1(f(x)-1) \mathrm{d}x$;

$(c)$ the trapezium rule with 10 intervals underestimates $\displaystyle \int_1^2 f(x-1) \mathrm{d}x$;

$(d)$ the trapezium rule with 10 intervals underestimates $\displaystyle \int_0^1(1-f(x)) \mathrm{d}x$.

</Example>

---

# Example 21

<Example>

The function $\displaystyle f(x)$ is defined for all real numbers and has the following properties, valid for all $\displaystyle x$ and $\displaystyle y$:

$(A)\quad f(x+y) = f(x)f(y)$

$(B)\quad \displaystyle \frac{\mathrm{d}f}{\mathrm{d}x} = f(x)$

$(C)\quad f(x) > 0$

Throughout this question, these should be the only properties of $f$ that you use; no marks will be awarded for any use of the exponential function.

Let $a = f(1)$.

(i) Show that $f(0) = 1$.

</Example>

---

# Example 21

<Example>

(ii) Let

$$I = \int_0^1 f(x) \mathrm{d}x$$

Show that $I = a - 1$.

(iii) The trapezium rule with $n$ steps is used to produce an estimate $I_n$ for the integral $I$. Show that

$$I_n = \frac{1}{2n}\left(\frac{b+1}{b-1}\right)(a-1)$$

where $b = f(1/n)$.

(iv) Given that $I_n \geqslant I$ for all $n$, show that

$$a \leqslant \left(1+\frac{2}{2n-1}\right)^n$$

</Example>

---

# *Simpson's rule

<div style="display: flex; align-items: center; gap: 20px;">

<div style="flex: 1;">

<Theorem title="Simpson's rule">

One can improve further to use quadratics to estimate a definite integral.

$$\displaystyle \int_a^b f(x) dx \approx \frac{b-a}{6}\left[f(a)+4f\left(\frac{a+b}{2}\right)+f(b)\right]$$

Note: Simpson's rule will yield exact values when calculating definite integrals of polynomials of degree $\displaystyle 3$ or less. Why?

</Theorem>

</div>

<div style="flex: 1;">

<img src="/Example/assets/6.png" alt="Simpson's rule illustration" style="max-width: 70%; height: auto; border: 1px solid #ccc;" />

</div>

</div>

---
layout: center
class: text-center
section: '1.6 微分方程'
---

# 1.6 微分方程(Differential equation)

---

# General solution vs. particular solution

<Remark type="remember">

A solution of a differential equation is an expression for the dependent variable in terms of the independent one(s) which satisfies the relation. The general solution includes all possible solutions and typically includes arbitrary constants (in the case of an ODE) or arbitrary functions (in the case of a PDE.) A solution without arbitrary constants/functions is called a particular solution. Often we find a particular solution to a differential equation by giving extra conditions in the form of initial or boundary conditions.

</Remark>

---

# Example 22

<Example>

Show that $\displaystyle \cos ct$ and $\displaystyle \sin ct$ are solutions of the second order ODE

$$\displaystyle \ddot{u} + c^2 u = 0$$

where $\displaystyle c$ is a constant.

Deduce that $\displaystyle A \cos ct + B \sin ct$ is also a solution for arbitrary constants $\displaystyle A, B$.

Note: The solution $\displaystyle u = A \cos ct + B \sin ct$ contains two arbitrary constants and is the general solution of the second order ODE $\displaystyle \ddot{u} + c^2 u = 0$. This illustrates the fact that the general solution of an $\displaystyle n$th order ODE contains $\displaystyle n$ arbitrary constants.

</Example>

---

# Exercise 22

<Question title="Exercise">

The function $\displaystyle y = e^{kx}$ satisfies the equation

$$\displaystyle \left(\frac{\mathrm{d}^2 y}{\mathrm{d}x^2} + \frac{\mathrm{d}y}{\mathrm{d}x}\right)\left(\frac{\mathrm{d}y}{\mathrm{d}x} - y\right) = y \frac{\mathrm{d}y}{\mathrm{d}x}$$

for

$(a)$ no values of $\displaystyle k$,

$(b)$ exactly one value of $\displaystyle k$,

$(c)$ exactly two distinct values of $\displaystyle k$,

$(d)$ exactly three distinct values of $\displaystyle k$,

$(e)$ infinitely many distinct values of $\displaystyle k$.

</Question>

---

# Integral equation

<Example>

For all real numbers $\displaystyle x$, the function $\displaystyle f(x)$ satisfies

$$\displaystyle 6 + f(x) = 2f(-x) + 3x^2\left(\int_{-1}^1 f(t) \mathrm{d}t\right)$$

It follows that $\displaystyle \int_{-1}^1 f(x) \mathrm{d}x$ equals

$(a)$ $\displaystyle 4$,

$(b)$ $\displaystyle 6$,

$(c)$ $\displaystyle 11$,

$(d)$ $\displaystyle \frac{27}{2}$,

$(e)$ $\displaystyle 23$.

</Example>

---

# Example 23

<Example>

For a positive number $\displaystyle a$, let

$$\displaystyle I(a) = \int_0^a\left(4-2^{x^2}\right) \mathrm{d}x$$

Then $\displaystyle \frac{\mathrm{d}I}{\mathrm{d}a} = 0$ when $\displaystyle a$ equals

$(a)$ $\displaystyle \frac{1+\sqrt{5}}{2}$,

$(b)$ $\displaystyle \sqrt{2}$,

$(c)$ $\displaystyle \frac{\sqrt{5}-1}{2}$,

$(d)$ $\displaystyle 1$.

</Example>

---

# Example 24

<Example>

Given a function $\displaystyle f(x)$, you are told that

$$\displaystyle \begin{aligned}
\int_0^1 3f(x) \mathrm{d}x + \int_1^2 2f(x) \mathrm{d}x & = 7 \\
\int_0^2 f(x) \mathrm{d}x + \int_1^2 f(x) \mathrm{d}x & = 1
\end{aligned}$$

It follows that $\displaystyle \int_0^2 f(x) \mathrm{d}x$ equals

$(a)$ $\displaystyle -1$,

$(b)$ $\displaystyle 0$,

$(c)$ $\displaystyle \frac{1}{2}$,

$(d)$ $\displaystyle 2$.

</Example>
